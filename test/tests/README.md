# 中国象棋游戏自动化测试方案

## 概述

本方案为"中国象棋"游戏项目设计了一套完整的自动化测试体系，确保游戏各项功能的稳定性和正确性。

## 测试环境配置

### 1. 安装Node.js环境

确保系统已安装Node.js (建议版本 14+)

### 2. 安装项目依赖

```bash
# 进入项目目录
cd /path/to/xiangqi

# 安装测试依赖
npm install
```

安装的依赖包括：
- Jest: JavaScript测试框架
- JSDOM: 浏览器环境模拟
- 其他必要的开发依赖

## 测试套件结构

```
tests/
├── board-initialization.test.js    # 棋盘初始化测试
├── piece-movement.test.js          # 棋子移动规则测试
├── capture-check.test.js           # 吃子和将军检测测试
├── famous-games.test.js            # 经典棋局测试
├── audio-system.test.js            # 音频系统测试
├── ui-interaction.test.js          # 用户界面交互测试
├── test-runner.js                  # 测试运行器
└── test-ui.html                    # 浏览器测试界面
```

## 各模块测试内容

### 1. 棋盘初始化测试 (board-initialization.test.js)

验证内容：
- 棋盘是否正确创建9×10格子
- 棋盘线条、楚河汉界是否正确绘制
- 炮位和兵位标记是否正确添加
- 32个棋子是否正确初始化
- 红黑双方棋子是否正确放置
- 棋子数据属性是否完整

### 2. 棋子移动规则测试 (piece-movement.test.js)

验证各棋子移动规则：
- 帅/将：九宫格内移动
- 士/仕：斜线移动，九宫格限制
- 象/相：田字移动，不能过河，蹩象腿
- 马：日字移动，蹩马腿
- 车：直线移动
- 炮：直线移动，隔子吃子
- 兵/卒：过河前后移动方式不同

### 3. 吃子和将军检测测试 (capture-check.test.js)

验证内容：
- 吃子功能是否正常
- 将军检测是否正确
- 游戏结束条件判断
- 移动后将军状态更新

### 4. 经典棋局测试 (famous-games.test.js)

验证四大名局：
- 七星聚会
- 蚯蚓降龙
- 野马操田
- 千里独行

验证内容：
- 棋局能否正确加载
- 棋子位置是否正确
- 开局演示是否正常工作

### 5. 音频系统测试 (audio-system.test.js)

验证内容：
- 音频管理器初始化
- 各类音效生成（移动、吃子、将军等）
- 背景音乐生成
- 音效播放功能
- 音量控制功能
- 音效开关功能

### 6. 用户界面交互测试 (ui-interaction.test.js)

验证内容：
- 按钮功能（新游戏、悔棋、棋谱等）
- 音频控制面板交互
- 棋子点击和移动交互
- 状态显示更新
- 被吃棋子显示

## 运行测试

### 1. 命令行运行

```bash
# 运行所有测试
npm test

# 运行测试并监听文件变化
npm run test:watch

# 运行测试并生成覆盖率报告
npm run test:coverage
```

### 2. 浏览器中运行

打开 `tests/test-ui.html` 文件，在浏览器中查看测试结果。

## 测试结果分析

### 通过标准

- 所有测试用例执行通过
- 无严重功能缺陷
- 代码覆盖率达标（建议80%以上）

### 失败处理

- 查看详细错误信息
- 定位问题代码
- 修复后重新运行测试
- 确保回归测试通过

## 持续集成建议

1. 将测试集成到Git钩子中，在提交代码前自动运行测试
2. 配置CI/CD流水线，在每次代码推送时自动运行测试
3. 设置测试覆盖率门禁，低于阈值禁止合并代码

## 测试维护

1. 随着功能增加，及时补充新的测试用例
2. 定期审查和更新测试用例
3. 优化测试性能，减少执行时间
4. 保持测试代码的可读性和可维护性

## 注意事项

1. 测试环境与生产环境尽可能一致
2. 测试数据应具有代表性和边界性
3. 测试用例应独立，避免相互依赖
4. 关注测试执行效率，避免过长的执行时间